5-12. The square of a directed graph *G=(V,E)* is the graph *G<sup>2</sup>=(V,E<sup>2</sup>)* such that *(u,w)∈E<sup>2</sup>* iff there exists *v∈V*
 such that *(u,v)∈E* and *(v,w)∈E*; i.e., there is a path of exactly two edges from *u* to *w* in the square of a graph Give efficient algorithms for both 
 adjacency lists and matrices.

**Solution**

To compute *G<sup>2</sup>*

*Adjacency list*

for each vertex in the adjacency list of node *u*
    for each vertex in the adjacency list of node *v*
for each vertex v in Adj[u]
for each vertex w in Adj[v]
edge(u, w) ∈ E2
insert w in Adj2(u)
where Adj2 is the adjacency-list representation of G2
. For every edge in Adj we scan at most |V |
vertices, thus we compute Adj2 in time O(V E).
After we have computed Adj2, we have to remove any duplicate edges from the lists (there may be
more than one two-edge path in G between any two vertices). Removing duplicate edges is done in
O(V +E0
) where E0 = O(V E) is the number of edges in Adj2 (see for instance problem CLRS 22.1-4).
Thus the total running time is O(V E)+O(V + E0
)= O(V E).
Let A denote the adjacency-matrix representation of G. The adjacency-matrix representation of G2
is
the square of A. Computing A2
can be done in time O(V
3
) (and even faster, theoretically; Strassen’s
algorithm for example will compute A2
in O(V
lg 7)).